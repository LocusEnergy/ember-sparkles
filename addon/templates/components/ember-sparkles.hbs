<g transform="translate({{marginLeft}},{{marginTop}})">

  {{#with (hash
    x-scale=(e-s/apply-method x-scale (append 0 innerWidth) method='range')
    y-scale=(e-s/apply-method y-scale (append innerHeight 0) method='range')
    color-scale=(cat-color-scale color-scale-type domain)
    transition=(ember-sparkles/transition duration=(or transition-duration 700) data=data)
  ) as |options|}}

    {{yield (hash
      x-axis=(component 'ember-sparkles/axis'
        scale=options.x-scale
        position='bottom'
        height=innerHeight
        transition=options.transition
        labelAttrs=(pipe (d3-attr 'x' width))
      )

      y-axis=(component 'ember-sparkles/axis'
        scale=options.y-scale
        position='left'
        width=innerWidth
        transition=options.transition
        labelAttrs=(pipe (d3-attr 'transform' 'rotate(-90)'))
      )

      bar-chart=(component 'ember-sparkles/bar-chart'
        width=innerWidth
        height=innerHeight
        tickFormat=(or tick-format '%Y-%m-%d')
      )

      grouped-bar-chart=(component 'ember-sparkles/grouped-bar-chart'
        width=innerWidth
        height=innerHeight

        inputKey=(r/get inputKey)
        valueKey=(r/get valueKey)
        outputKey=(r/get outputKey)
        groupKey=(r/get groupKey)

        data=data

        xScale=options.x-scale
        yScale=options.y-scale
        groupScale=(band-scale
          domain
          (append 0 (compute options.x-scale.bandwidth))
          padding=groupPadding
        )

        colorScale=options.color-scale
        transition=options.transition
      )

      line-chart=(component 'ember-sparkles/line-chart'
        width=innerWidth height=innerHeight
      )

      pie-chart=(component 'ember-sparkles/pie-chart'
        width=innerWidth
        height=innerHeight
        colorScale=options.color-scale
        radius=(div (d3-array 'min' (array width height)) 2)
        transition=options.transition
      )

      legend=(component 'ember-sparkles/legend'
        width=innerWidth
        height=innerHeight
        domain=domain
        colorScale=options.color-scale
        transition=options.transition
        dx=(or dx 0)
        dy=(or dy 0)
      )

      width=innerWidth
      height=innerHeight
    )}}

  {{/with}}
</g>
