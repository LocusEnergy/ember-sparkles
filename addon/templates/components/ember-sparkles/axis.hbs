{{#with (hash
  position=position
  ticks=ticks
  width=width
  height=height
  tickFormat=(or tick-format '%Y-%m')
  skipIdx=responsiveSkipIdx
  xGrid=xGrid
  yGrid=yGrid
  ) as |options|}}

  {{#d3-graph as |d3|}}

    {{d3.graph (pipe
      (d3-append 'g')
      (d3-attr 'class' 'axis')
      (d3-attr 'transform' (i 'translate(0,${h})' h=height))
    )}}

    {{d3.graph (pipe
      (d3-select-all '.axis')
      (if with-transition (d3-transition transition) (d3-noop))
      (d3-call (ember-sparkles/axis scale options))
    )}}

    {{#if label}}
      {{d3.graph (pipe
        (d3-append 'text')
        (d3-attr 'class' 'label')
        (d3-attr 'transform' 'rotate(-90)')
        (d3-style 'text-anchor' 'end')
        (d3-text label)
      )}}

      {{d3.graph (pipe
        (d3-select-all '.label')
        (if with-transition (d3-transition transition) (d3-noop))
        (d3-attr 'y' (or dy 6))
        (d3-attr 'x' (or dx (mult -0.4 options.height)))
      )}}
    {{/if}}

  {{/d3-graph}}

{{/with}}

{{!-- y axis --}}
{{!-- {{d3.graph (pipe
  (d3-attr 'class' 'y axis')
  (d3-append 'text')
  (d3-attr 'class' 'vertical-label')
  (d3-attr 'transform' 'rotate(-90)')
  (d3-style 'text-anchor' 'end')
  (d3-text y-label)
)}} --}}

{{!-- {{#with (ember-sparkles/axis yScale position='left' ticks=ticks width=width) as |axis|}}
  {{d3.graph (pipe
    (d3-select-all '.y.axis')
    (if with-transition (d3-transition transition) (d3-noop))
    (d3-call axis)
  )}}
{{/with}} --}}

{{!-- position vertical label programmatically based on height; -0.4*height is a nice default --}}
{{!-- {{d3.graph (pipe
  (d3-select-all '.vertical-label')
  (if with-transition (d3-transition transition) (d3-noop))
  (d3-attr 'y' (or vertical-label-dy 6))
  (d3-attr 'x' (or vertical-label-dx (mult -0.4 height)))
)}} --}}
